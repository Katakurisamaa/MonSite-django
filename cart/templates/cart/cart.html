{% extends 'base.html' %}
{% load static %}
{% block titre %}Panier{% endblock %}

{% block content %}
<section class="section-content padding-y bg">
  <div class="container-fluid">
    {% if not cart_items %}
<h2 class="mt-2 text-center">
  Votre panier est vide 
  <svg xmlns="http://www.w3.org/2000/svg" color="black" width="26" height="26" fill="currentColor" class="bi bi-emoji-frown" viewBox="0 0 16 16">
    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
    <path d="M4.285 12.433a.5.5 0 0 0 .683-.183A3.498 3.498 0 0 1 8 10.5c1.295 0 2.426.703 3.032 1.75a.5.5 0 0 0 .866-.5A4.498 4.498 0 0 0 8 9.5a4.5 4.5 0 0 0-3.898 2.25.5.5 0 0 0 .183.683zM7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5zm4 0c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5z"/>
  </svg>
</h2>
 <br>
<center class="mb-4">
  <a href="{% url 'boutique' %}" class="btn bg-primary btn">
    Poursuivre mes achats
  </a>
</center>
{% else %}
<div class="row mt-2">
  <aside class="col-sm-7" style="background-color:white;">
    <div class="row">
      {% for cart_item in cart_items %}
      <div class="col-sm-6 mb-2">
        <img w-100 src="{{ cart_item.product.images.url }}" class="img-thumbnail" alt="">
      </div>
      <div class="col-sm-6 mb-2">
        <p>
          <span class="text-muted">
            <span>Article :</span> {{ cart_item.product.product_name }}
            <br>
            {% if cart_item.variations.all %}
              {% for item in cart_item.variations.all %}
                {{ item.variation_category | capfirst }} : {{ item.variation_value | capfirst }} <br>
              {% endfor %}
            {% endif %}
          </span>
          <span class="text-muted">Prix de l'article:</span>
          <span class="text-muted">{{ cart_item.product.price }}€</span>
        </p>

        <p>
          <span class="text-muted">Quantité</span>
            <div class="row ">

              <div class="col-2 input-minus me-2 mt-1">
                <a href="{% url 'remove_cart' cart_item.product.id cart_item.id %}" class="btn" style="background-color:whitesmoke;" type="button" id="button-minus"><i class="fa fa-minus"></i></a>
              </div>
              
              <div class="col-4 inline-block">
                <form action="">
                  <input type="text" class="form-control text-center" value="{{ cart_item.quantity }}">
                </form>
              </div>

              <div class="col-2 input-plus me-1 mt-1">
                <form action="{% url 'add_cart' cart_item.product.id %}" method="POST">
                  {% csrf_token %}
                  {% for item in cart_item.variations.all %}
                  <input type="hidden" name="{{ item.variation_category | lower }}" value="{{ item.variation_value | capfirst }}">
									{% endfor %}
                  <button style="background-color:whitesmoke;" class="btn btn-light" type="submit" id="button-plus"><i class="fa fa-plus"></i></button>
                </form>
              </div>

            </div>
        </p>

        <p>
          <span class="text-muted">Prix total:</span>
          <span class="text-muted">{{ cart_item.sub_total}}€</span>
        </p>

        <p class="d-grid">
          <a href="{% url 'remove_cart_item' cart_item.product.id cart_item.id %}" onclick="return confirm('Are you sure you want to delete this item?')" class="btn btn-danger">Supprimer</a>
        </p>
      </div>
      {% endfor %}
    </div>
  </aside>

  <aside class="col-sm-4 finalisation" style="background-color:white;">
    <table class="table">
      <thead>
        <tr>
          <th scope="col">PRIX TOTAL</th>
          <th scope="col">LIVRAISON</th>
          <th scope="col">TOTAUX</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="text-center">{{total}}€</td>
          <td class="text-center">{{ tax }}€</td>
          <td class="text-center">{{ grand_total }}</td>
        </tr>
      </tbody>
    </table>
    <div class="text-center mt-1">
      <img src="{% static 'payments.png' %}" alt="">
    </div>
    <div class="d-grid text-center mt-5">
      <a href="#" class="btn btn-primary btn">Commander</a>
    </div>
    <div class="d-grid  text-center mt-2 mb-2">
      <a href="{% url 'boutique' %}" class="btn bg-light btn">Poursuivre mes achats</a>
    </div>
  </aside>
</div>
{% endif %}
</section>
{% endblock %}
